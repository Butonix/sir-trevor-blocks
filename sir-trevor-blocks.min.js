!function(){"use strict";return SirTrevor?void(SirTrevor.Blocks.Button=SirTrevor.Block.extend({type:"button",title:"Button",icon_name:"image",cssProperties:{display:"block",textDecoration:"none",margin:"0 auto",border:"2px solid",textAlign:"center",backgroundColor:{label:"Background Color",input:{type:"color"}},borderWidth:{label:"Border Width",input:{type:"range",min:0,max:6,step:1,units:"px"}},borderColor:{label:"Border Color",input:{type:"color"}},borderRadius:{label:"Border Radius",input:{type:"range",min:0,max:100,step:1,units:"px"}},width:{label:"Width",input:{type:"range",min:10,max:100,step:1,units:"%"}},lineHeight:{label:"Height",input:{type:"range",min:0,max:500,step:1,units:"%"}},fontStyle:{label:"Italic",input:{type:"checkbox",value:"italic"}},fontWeight:{label:"Bold",input:{type:"checkbox",value:"bold"}}},_namePrepend:"st-button",_cssInputNamePrepend:"css_",editorHTML:function(){var e=this,t=$("<div>",{"class":"st-button"}),i=$("<div>",{"class":"st-button-editor"}),n=$("<div>",{"class":"st-button-preview"}),r=[{property:"caption",text:"Caption"},{property:"href",text:"href"},{property:"onclick",text:"On Click"}];return r.forEach(function(t){var n=$("<div>");n.addClass(e._namePrepend+"-style"),n.addClass(e._namePrepend+"-style-"+t.property),n.append($("<input>",{type:"text",name:t.property,placeholder:t.text})),i.append(n)}),Object.keys(e.cssProperties).forEach(function(t){var n=$("<div>"),r=e.cssProperties[t];t=e._decamelize(t),n.addClass(e._namePrepend+"-style"),n.addClass(e._namePrepend+"-style-"+t),_.isObject(r)?Object.keys(r).forEach(function(i){var a=r[i],o=$("<"+i+">");_.isObject(a)?(Object.keys(a).forEach(function(e){var t=a[e];"html"!=e?o.attr(e,t):o.html(t)}),(!o.attr("name")||o.attr("name").length<=0)&&o.attr("name",e._cssInputNamePrepend+t)):o.html(a),n.append(o)}):n.append($("<input>",{type:"hidden",name:e._cssInputNamePrepend+t,value:r})),i.append(n)}),t.append(i),e.$preview=t.append(n),t.html()},_getBackgroundColorForForegroundColor:function(e){e=e.substr(1);var t=parseInt(e.substr(0,2),16),i=parseInt(e.substr(2,2),16),n=parseInt(e.substr(4,2),16),r=(299*t+587*i+114*n)/1e3;return r>=128?"black":"white"},loadData:function(e){var t=this;delete e.text,delete e.format,Object.keys(e).forEach(function(i){var n=e[i];_.isObject(n)?Object.keys(n).forEach(function(e){var r=n[e],a='[class*="'+t._namePrepend+"-"+i+"-"+e+'"] > input',o=t.$editor.find(a);"range"==o.attr("type")?o.val(parseInt(r)):"checkbox"==o.attr("type")?o.prop("checked",o.val()==r):o.val(r)}):t.$editor.find('[name="'+i+'"]').val(n)}),t._renderPreview(t)()},onBlockRender:function(){this.$editor.on("change",this._renderPreview(this)),this.$editor.on("input",this._renderPreview(this))},_renderPreview:function(e){return function(t){var i=e.toHTML();e.$el.find(".st-button-preview").html(i)}},_decamelize:function(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()},_serializeData:function(){var e=this,t={};t.caption=e.$el.find('input[name="caption"]').val(),t.href=e.$el.find('input[name="href"]').val(),t.onclick=e.$el.find('input[name="onclick"]').val(),t.style={};var i=e.$el.find('input[name^="'+e._cssInputNamePrepend+'"]');return i.each(function(i,n){n=$(n);var r=new RegExp("^"+e._cssInputNamePrepend,"i"),a=n.attr("name"),o=n.attr("units"),s=a.replace(r,"");if(r.test(a)&&s.length>0){var l=n.val();isNaN(l)||(l+=o&&o.length>0?o:"px"),"checkbox"!=n.attr("type")&&"radio"!=n.attr("type")||n.is(":checked")||(l=""),t.style[s]=l}}),t.text=e.toHTML(t),t.format="html",t},toHTML:function(e){var t=this;e=e||t.getBlockData();var i=$("<a>");return i.attr("onclick",e.onclick),i.attr("href",e.href),i.html(e.caption),Object.keys(e.style).forEach(function(t){i.css(t,e.style[t])}),e.style["background-color"]&&i.css("color",t._getBackgroundColorForForegroundColor(e.style["background-color"])),i[0].outerHTML}})):console.error("SirTrevor.Blocks.Button could not load because SirTrevor wasn't found")}(),function(){"use strict";return SirTrevor?void(SirTrevor.Blocks.ImageEdit=SirTrevor.Blocks.Image.extend({type:"image_edit",cropTimeout:1e3,loadData:function(e){this.$editor.html($("<img>",{src:e.file.url})).show()},onDrop:function(e){var t=e.files[0],i="undefined"!=typeof URL?URL:"undefined"!=typeof webkitURL?webkitURL:null;if(/image/.test(t.type)){this.$inputs.hide(),this.$editor.html($("<img>",{src:i.createObjectURL(t)})).show(),this.loading();var n=null,r=this.$editor.find(">img");r.cropper({built:function(){this.$cropper=function(){return r.cropper.apply(r,arguments)},this.ready()}.bind(this),crop:function(e){n?clearTimeout(n):SirTrevor.EventBus.trigger("image_edit:crop:start",[e]),n=setTimeout(function(){n=null,SirTrevor.EventBus.trigger("image_edit:crop:finish",[e])}.bind(this),this.cropTimeout)}.bind(this)})}},isEmpty:function(){return this.$editor.find("img").length<=0},_serializeData:function(){var e=null;return e=this.$cropper?this.$cropper("getCroppedCanvas").toDataURL():this.$editor.find("img").attr("src"),e&&e.length>0?{file:{url:e}}:null}})):console.error("SirTrevor.Blocks.ImageEdit could not load because SirTrevor wasn't found")}(),function(){"use strict";return SirTrevor?void(SirTrevor.Blocks.Map=SirTrevor.Block.extend({type:"map",title:"Map",icon_name:"map",default_width:600,default_height:300,default_zoom:15,map_static_img:"https://maps.googleapis.com/maps/api/staticmap?size=<%= width %>x<%= height %>&center=<%= address %>&markers=|<%= address %>&zoom=<%= zoom %>&scale=2",map_link:"http://maps.google.com/maps?q=<%= address %>",editorHTML:function(){var e=$("<input>",{type:"text",name:"address",placeholder:"Write an address here!"}),t=$("<input>",{type:"hidden",name:"zoom",value:this.default_zoom}),i=$("<input>",{type:"hidden",name:"width",value:this.default_width}),n=$("<input>",{type:"hidden",name:"height",value:this.default_height}),r=$("<div>",{"class":"map"}),a=$("<div>");return a.append(e),a.append(t),a.append(i),a.append(n),a.append(r),r.css({"border-radius":"5px","background-color":"#DDD","background-position":"center","background-size":"cover",height:this.default_height+"px",width:"100%"}),r.hide(),a.html()},inputTimeoutAmount:1e3,inputTimeoutId:null,onBlockRender:function(){this.$map=this.$el.find(".map"),this.$zoom=this.$el.find('[name="zoom"]');var e=function(){window.open(this._getGmapsLink())}.bind(this),t=function(e){if(this.$map.is(":hover")){e.preventDefault();var t=e.originalEvent,i=t.deltaY||t.wheelDelta;i>0?this.$zoom.val(Math.max(0,Number(this.$zoom.val())-1)):this.$zoom.val(Number(this.$zoom.val())+1),this._reloadMap()}}.bind(this);this.$editor.bind("keypress keydown keyup",function(e){13==e.keyCode&&e.preventDefault()}),this.$map.on("click",e),this.$editor.is(":visible")&&(this.$map.on("wheel mousewheel",t),this.$editor.on("keyup change",this._reloadMap.bind(this)))},loadData:function(e){Object.keys(e).forEach(function(t){this.$el.find('[name="'+t+'"]').val(e[t])}.bind(this)),this.$editor.hide(),this._reloadMap()},isEmpty:function(){return!(this.$el&&this.$el.find('[name="address"]').length>0&&this.$el.find('[name="address"]').val().length>0)},_serializeData:function(){var e=this.$el.find('[name="address"]').val();return!e||e.length<=0?null:{address:e,zoom:this.$el.find('[name="zoom"]').val(),width:this.$el.find('[name="width"]').val(),height:this.$el.find('[name="height"]').val()}},_safeData:function(e){var t={};return Object.keys(e).forEach(function(i){t[i]=encodeURIComponent(e[i])}),t},_reloadMap:function(){var e=this.$map||this.$el.find(".map");e.is(":visible")||e.show(),this.$el.hasClass("st--is-loading")||(this.loading(),e.css("opacity","0.7")),clearTimeout(this.inputTimeoutId),this.inputTimeoutId=setTimeout(function(){this.ready(),e.css("opacity","1"),e.css("background-image","url("+this._getGmapsStaticImage()+")")}.bind(this),this.inputTimeoutAmount)},_getGmapsLink:function(){return _.template(this.map_link,this._safeData(this.getData().data))},_getGmapsStaticImage:function(){return _.template(this.map_static_img,this._safeData(this.getData().data))}})):console.error("SirTrevor.Blocks.Map could not load because SirTrevor wasn't found")}(),function(){"use strict";return SirTrevor?void(SirTrevor.Blocks.Widget=SirTrevor.Block.extend({type:"widget",title:"Widget",icon_name:"code",pastable:!0,paste_options:{html:['<div style="text-align: center;  padding:20px;">',"  <span>Paste your external widget html here</span>",'  <textarea class="st-paste-block" style="width: 100%; padding: 0.6em; border: 1px solid #D4D4D4;"  placeholder="Paste your code here"></textarea>',"</div>"].join("\n")},_serializeData:function(){return{format:"html",text:this.$el.find("textarea").val()}},isEmpty:function(){return!(this.$el&&this.$el.find("textarea").length>0&&this.$el.find("textarea").val().length>0)},loadData:function(e){this.loadPastedContent(e.text)},onContentPasted:function(e){this.loadPastedContent($(e.target).val())},loadPastedContent:function(e){this.$el.find("textarea").val(e),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;");var t=$("<pre>"),i=$("<code>",{"class":"lang-html"});i.html(e),hljs.highlightBlock(i.get()[0]),t.append(i),this.$editor.html(t),this.$inputs.hide()}})):console.error("SirTrevor.Blocks.Widget could not load because SirTrevor wasn't found")}();
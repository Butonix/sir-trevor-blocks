!function(){var t={en:{blocks:{button:{title:"Button",styles:{backgroundColor:"Background Color",borderWidth:"Border Width",borderColor:"Border Color",borderRadius:"Border Radius",width:"Width",height:"Height"},hint:{text:"¡Escribe aqui el texto de tu Boton!",href:"Enlace"}},map:{title:"Map",hint:"Write an address here"},widget:{title:"Widget",hint:"Paste your external Widget html here"}}}};jQuery.extend(!0,SirTrevor.Locales,t)}(),function(){var t={es:{blocks:{button:{title:"Botón",styles:{backgroundColor:"Color de fondo",borderWidth:"Ancho del borde",borderColor:"Color del borde",borderRadius:"Radio del borde",width:"Ancho",height:"Alto"},hint:{text:"¡Escribe aqui el texto de tu Boton!",href:"Enlace"}},map:{title:"Mapa",hint:"Escribe una direccion aquí"},widget:{title:"Widget",hint:"Pega el html de tu widget externo aquí"}}}};jQuery.extend(!0,SirTrevor.Locales,t)}(),function(){"use strict";return SirTrevor?void(SirTrevor.Blocks.Button=SirTrevor.Block.extend({type:"button",title:function(){return i18n.t("blocks:button:title")},icon_name:"button",editorHTML:function(){return'<div class="st-editor"><div class="st-preview"><p class="st-required st-text-block" contenteditable="true"></p></div><div class="st-row"> <input name="href" type="text"></div><div class="st-row"><div class="st-column"><div class="st-control"><div class="st-icon">C</div> <input class="st-value" name="css-background-color" type="color"></div><div class="st-control"><div class="st-icon">W</div> <input class="st-value" name="css-width" type="range" units="%" step="1" max="100" min="10"></div><div class="st-control"><div class="st-icon">H</div> <input class="st-value" name="css-line-height" type="range" units="%" step="1" max="500" min="10"></div></div><div class="st-column"><div class="st-control"><div class="st-icon">B</div> <input class="st-value" name="css-border-color" type="color"></div><div class="st-control"><div class="st-icon">B</div> <input class="st-value" name="css-border-width" type="range" units="px" step="1" max="6" min="0"></div><div class="st-control"><div class="st-icon">B</div> <input class="st-value" name="css-border-radius" type="range" units="px" step="1" max="100" min="0"></div></div></div></div>'},onBlockRender:function(){this.$preview=this.$el.find(".st-preview"),this.$css=this.$editor.find('[name^="css-"]'),this.$preview.find('[contenteditable="true"]').html(i18n.t("blocks:button:hint:text")),this.$css.on("change input",this._onCssPropertyChange.bind(this)),this.$css.filter('[name="css-background-color"]').on("change input",this._onBackgroundColorChange.bind(this)),this.$preview.addClass("default"),this._loadDefaultProperties()},_loadDefaultProperties:function(){this.$css.each(function(t,e){var i=$(e),s=i.attr("name").replace(/^css\-/,""),o=(i.val(),i.attr("units")||""),n=this.$preview.css(s),r=n.replace(o,"");i.val(r)}.bind(this))},_onCssPropertyChange:function(t){var e=$(t.target),i=e.attr("name").replace(/^css\-/,""),s=e.val();e.attr("units")&&e.attr("units").length>0&&(s+=e.attr("units")),this.$preview.css(i,s)},_onBackgroundColorChange:function(){this.$preview.css("color",this._getFontColor.bind(this)())},_getFontColor:function(t){var e,i,s,o=/^#/,n=/^rgb\(.*([0-9]+).*,.*([0-9]+),.*([0-9]+).*\)/,r=t||this.$preview.css("background-color");if(o.test(r))r=r.substr(1),e=parseInt(r.substr(0,2),16),i=parseInt(r.substr(2,2),16),s=parseInt(r.substr(4,2),16);else if(n.test(r)){var a=rgb.exec();e=parseInt(a[1]),i=parseInt(a[2]),s=parseInt(a[3])}var l=(299*e+587*i+114*s)/1e3;return l>=128?"inherit":"#FFFFFF"}})):console.error("SirTrevor.Blocks.Button could not load because SirTrevor wasn't found")}(),function(){"use strict";return SirTrevor?void(SirTrevor.Blocks.ImageEdit=SirTrevor.Blocks.Image.extend({title:function(){return i18n.t("blocks:image:title")},type:"image_edit",cropTimeout:1e3,loadData:function(t){this.$editor.html($("<img>",{src:t.file.url})).show()},onDrop:function(t){var e=t.files[0],i="undefined"!=typeof URL?URL:"undefined"!=typeof webkitURL?webkitURL:null;if(/image/.test(e.type)){this.$inputs.hide(),this.$editor.html($("<img>",{src:i.createObjectURL(e)})).show(),this.loading();var s=null,o=this.$editor.find(">img");o.cropper({built:function(){this.$cropper=function(){return o.cropper.apply(o,arguments)},this.ready()}.bind(this),crop:function(t){s?clearTimeout(s):SirTrevor.EventBus.trigger("image_edit:crop:start",[t]),s=setTimeout(function(){s=null,SirTrevor.EventBus.trigger("image_edit:crop:finish",[t])}.bind(this),this.cropTimeout)}.bind(this)})}},isEmpty:function(){return this.$editor.find("img").length<=0},_serializeData:function(){var t=null;return t=this.$cropper?this.$cropper("getCroppedCanvas").toDataURL():this.$editor.find("img").attr("src"),t&&t.length>0?{file:{url:t}}:null}})):console.error("SirTrevor.Blocks.ImageEdit could not load because SirTrevor wasn't found")}(),function(){"use strict";return SirTrevor?void(SirTrevor.Blocks.Map=SirTrevor.Block.extend({type:"map",title:function(){return i18n.t("blocks:map:title")},icon_name:"map",default_width:600,default_height:300,default_zoom:15,map_static_img:"https://maps.googleapis.com/maps/api/staticmap?size=<%= width %>x<%= height %>&center=<%= address %>&markers=|<%= address %>&zoom=<%= zoom %>&scale=2",map_link:"http://maps.google.com/maps?q=<%= address %>",editorHTML:function(){var t=$("<input>",{type:"text",name:"address",placeholder:i18n.t("blocks:map:hint")}),e=$("<input>",{type:"hidden",name:"zoom",value:this.default_zoom}),i=$("<input>",{type:"hidden",name:"width",value:this.default_width}),s=$("<input>",{type:"hidden",name:"height",value:this.default_height}),o=$("<div>",{"class":"map"}),n=$("<div>");return n.append(t),n.append(e),n.append(i),n.append(s),n.append(o),o.css({"border-radius":"5px","background-color":"#DDD","background-position":"center","background-size":"cover",height:this.default_height+"px",width:"100%"}),o.hide(),n.html()},inputTimeoutAmount:1e3,inputTimeoutId:null,onBlockRender:function(){this.$map=this.$el.find(".map"),this.$zoom=this.$el.find('[name="zoom"]');var t=function(){window.open(this._getGmapsLink())}.bind(this),e=function(t){if(this.$map.is(":hover")){t.preventDefault();var e=t.originalEvent,i=e.deltaY||e.wheelDelta;i>0?this.$zoom.val(Math.max(0,Number(this.$zoom.val())-1)):this.$zoom.val(Number(this.$zoom.val())+1),this._reloadMap()}}.bind(this);this.$editor.bind("keypress keydown keyup",function(t){13==t.keyCode&&t.preventDefault()}),this.$map.on("click",t),this.$editor.is(":visible")&&(this.$map.on("wheel mousewheel",e),this.$editor.on("keyup change",this._reloadMap.bind(this)))},loadData:function(t){Object.keys(t).forEach(function(e){this.$el.find('[name="'+e+'"]').val(t[e])}.bind(this)),this.$editor.hide(),this._reloadMap()},isEmpty:function(){return!(this.$el&&this.$el.find('[name="address"]').length>0&&this.$el.find('[name="address"]').val().length>0)},_serializeData:function(){var t=this.$el.find('[name="address"]').val();return!t||t.length<=0?null:{address:t,zoom:this.$el.find('[name="zoom"]').val(),width:this.$el.find('[name="width"]').val(),height:this.$el.find('[name="height"]').val()}},_safeData:function(t){var e={};return Object.keys(t).forEach(function(i){e[i]=encodeURIComponent(t[i])}),e},_reloadMap:function(){var t=this.$map||this.$el.find(".map");t.is(":visible")||t.show(),this.$el.hasClass("st--is-loading")||(this.loading(),t.css("opacity","0.7")),clearTimeout(this.inputTimeoutId),this.inputTimeoutId=setTimeout(function(){this.ready(),t.css("opacity","1"),t.css("background-image","url("+this._getGmapsStaticImage()+")")}.bind(this),this.inputTimeoutAmount)},_getGmapsLink:function(){return _.template(this.map_link,this._safeData(this.getData().data))},_getGmapsStaticImage:function(){return _.template(this.map_static_img,this._safeData(this.getData().data))}})):console.error("SirTrevor.Blocks.Map could not load because SirTrevor wasn't found")}(),function(){"use strict";return SirTrevor?void(SirTrevor.Blocks.VideoNoDrag=SirTrevor.Blocks.Video.extend({droppable:!1})):console.error("SirTrevor.Blocks.VideoNoDrag could not load because SirTrevor wasn't found")}(),function(){"use strict";return SirTrevor?void(SirTrevor.Blocks.Widget=SirTrevor.Block.extend({type:"widget",title:function(){return i18n.t("blocks:widget:title")},icon_name:"code",pastable:!0,paste_options:{html:'<div class="st-widget-editor-container"><span class="st-icon"></span><textarea class="st-paste-block" placeholder="<%= i18n.t("blocks:widget:hint") %>"></textarea></div>'},_serializeData:function(){return{format:"html",text:this.$el.find("textarea").val()}},isEmpty:function(){return!(this.$el&&this.$el.find("textarea").length>0&&this.$el.find("textarea").val().length>0)},loadData:function(t){this.loadPastedContent(t.text)},onContentPasted:function(t){this.loadPastedContent($(t.target).val())},loadPastedContent:function(t){t=t||"",this.$el.find("textarea").val(t),t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;");var e=$("<pre>"),i=$("<code>",{"class":"lang-html"});i.html(t),hljs.highlightBlock(i.get()[0]),e.append(i),this.$editor.html(e),this.$inputs.hide()}})):console.error("SirTrevor.Blocks.Widget could not load because SirTrevor wasn't found")}();
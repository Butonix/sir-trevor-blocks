!function(){"use strict";return SirTrevor?void(SirTrevor.Blocks.Button=SirTrevor.Block.extend({type:"button",title:"Button",icon_name:"image",cssProperties:{display:"block",textDecoration:"none",margin:"0 auto",border:"2px solid",textAlign:"center",backgroundColor:{label:"Background Color",input:{type:"color"}},borderWidth:{label:"Border Width",input:{type:"range",min:0,max:6,step:1,units:"px"}},borderColor:{label:"Border Color",input:{type:"color"}},borderRadius:{label:"Border Radius",input:{type:"range",min:0,max:100,step:1,units:"px"}},width:{label:"Width",input:{type:"range",min:10,max:100,step:1,units:"%"}},lineHeight:{label:"Height",input:{type:"range",min:0,max:500,step:1,units:"%"}},fontStyle:{label:"Italic",input:{type:"checkbox",value:"italic"}},fontWeight:{label:"Bold",input:{type:"checkbox",value:"bold"}}},_namePrepend:"st-button",_cssInputNamePrepend:"css_",editorHTML:function(){var t=this,e=$("<div>",{"class":"st-button"}),i=$("<div>",{"class":"st-button-editor"}),r=$("<div>",{"class":"st-button-preview"}),n=[{property:"caption",text:"Caption"},{property:"href",text:"href"},{property:"onclick",text:"On Click"}];return n.forEach(function(e){var r=$("<div>");r.addClass(t._namePrepend+"-style"),r.addClass(t._namePrepend+"-style-"+e.property),r.append($("<input>",{type:"text",name:e.property,placeholder:e.text})),i.append(r)}),Object.keys(t.cssProperties).forEach(function(e){var r=$("<div>"),n=t.cssProperties[e];e=t._decamelize(e),r.addClass(t._namePrepend+"-style"),r.addClass(t._namePrepend+"-style-"+e),_.isObject(n)?Object.keys(n).forEach(function(i){var a=n[i],o=$("<"+i+">");_.isObject(a)?(Object.keys(a).forEach(function(t){var e=a[t];"html"!=t?o.attr(t,e):o.html(e)}),(!o.attr("name")||o.attr("name").length<=0)&&o.attr("name",t._cssInputNamePrepend+e)):o.html(a),r.append(o)}):r.append($("<input>",{type:"hidden",name:t._cssInputNamePrepend+e,value:n})),i.append(r)}),e.append(i),t.$preview=e.append(r),e.html()},_getBackgroundColorForForegroundColor:function(t){t=t.substr(1);var e=parseInt(t.substr(0,2),16),i=parseInt(t.substr(2,2),16),r=parseInt(t.substr(4,2),16),n=(299*e+587*i+114*r)/1e3;return n>=128?"black":"white"},loadData:function(t){var e=this;delete t.text,delete t.format,Object.keys(t).forEach(function(i){var r=t[i];_.isObject(r)?Object.keys(r).forEach(function(t){var n=r[t],a='[class*="'+e._namePrepend+"-"+i+"-"+t+'"] > input',o=e.$editor.find(a);"range"==o.attr("type")?o.val(parseInt(n)):"checkbox"==o.attr("type")?o.prop("checked",o.val()==n):o.val(n)}):e.$editor.find('[name="'+i+'"]').val(r)}),e._renderPreview(e)()},onBlockRender:function(){this.$editor.on("change",this._renderPreview(this)),this.$editor.on("input",this._renderPreview(this))},_renderPreview:function(t){return function(e){var i=t.toHTML();t.$el.find(".st-button-preview").html(i)}},_decamelize:function(t){return t.replace(/([A-Z])/g,"-$1").toLowerCase()},_serializeData:function(){var t=this,e={};e.caption=t.$el.find('input[name="caption"]').val(),e.href=t.$el.find('input[name="href"]').val(),e.onclick=t.$el.find('input[name="onclick"]').val(),e.style={};var i=t.$el.find('input[name^="'+t._cssInputNamePrepend+'"]');return i.each(function(i,r){r=$(r);var n=new RegExp("^"+t._cssInputNamePrepend,"i"),a=r.attr("name"),o=r.attr("units"),s=a.replace(n,"");if(n.test(a)&&s.length>0){var l=r.val();isNaN(l)||(l+=o&&o.length>0?o:"px"),"checkbox"!=r.attr("type")&&"radio"!=r.attr("type")||r.is(":checked")||(l=""),e.style[s]=l}}),e.text=t.toHTML(e),e.format="html",e},toHTML:function(t){var e=this;t=t||e.getBlockData();var i=$("<a>");return i.attr("onclick",t.onclick),i.attr("href",t.href),i.html(t.caption),Object.keys(t.style).forEach(function(e){i.css(e,t.style[e])}),t.style["background-color"]&&i.css("color",e._getBackgroundColorForForegroundColor(t.style["background-color"])),i[0].outerHTML}})):console.error("SirTrevor.Blocks.Button could not load because SirTrevor wasn't found")}(),function(){"use strict";return SirTrevor?void(SirTrevor.Blocks.ImageEdit=SirTrevor.Blocks.Image.extend({type:"image_edit",cropTimeout:1e3,loadData:function(t){this.$editor.html($("<img>",{src:t.file.url})).show()},onDrop:function(t){var e=t.files[0],i="undefined"!=typeof URL?URL:"undefined"!=typeof webkitURL?webkitURL:null;if(/image/.test(e.type)){this.$inputs.hide(),this.$editor.html($("<img>",{src:i.createObjectURL(e)})).show(),this.loading();var r=null,n=this.$editor.find(">img");n.cropper({built:function(){this.$cropper=function(){return n.cropper.apply(n,arguments)},this.ready()}.bind(this),crop:function(t){r?clearTimeout(r):SirTrevor.EventBus.trigger("image_edit:crop:start",[t]),r=setTimeout(function(){r=null,SirTrevor.EventBus.trigger("image_edit:crop:finish",[t])}.bind(this),this.cropTimeout)}.bind(this)})}},_serializeData:function(){var t={file:{url:null}};return this.$cropper?t.file.url=this.$cropper("getCroppedCanvas").toDataURL():t.file.url=this.$editor.find("img").attr("src"),t}})):console.error("SirTrevor.Blocks.ImageEdit could not load because SirTrevor wasn't found")}(),function(){"use strict";return SirTrevor?void(SirTrevor.Blocks.Map=SirTrevor.Block.extend({type:"map",title:"Map",icon_name:"map",default_width:600,default_height:300,default_zoom:15,map_static_img:"https://maps.googleapis.com/maps/api/staticmap?size=<%= width %>x<%= height %>&center=<%= address %>&markers=|<%= address %>&zoom=<%= zoom %>&scale=2",map_link:"http://maps.google.com/maps?q=<%= address %>",editorHTML:function(){var t=$("<input>",{type:"text",name:"address",placeholder:"Write an address here!"}),e=$("<input>",{type:"hidden",name:"zoom",value:this.default_zoom}),i=$("<input>",{type:"hidden",name:"width",value:this.default_width}),r=$("<input>",{type:"hidden",name:"height",value:this.default_height}),n=$("<div>",{"class":"map"}),a=$("<div>");return a.append(t),a.append(e),a.append(i),a.append(r),a.append(n),n.css({"border-radius":"5px","background-color":"#DDD","background-position":"center","background-size":"cover",height:this.default_height+"px",width:"100%"}),a.html()},inputTimeoutAmount:1e3,inputTimeoutId:null,onBlockRender:function(){this.$map=this.$el.find(".map"),this.$zoom=this.$el.find('[name="zoom"]');var t=function(){window.open(this._getGmapsLink())}.bind(this),e=function(t){if(this.$map.is(":hover")){t.preventDefault();var e=t.originalEvent,i=e.deltaY||e.wheelDelta;i>0?this.$zoom.val(Math.max(0,Number(this.$zoom.val())-1)):this.$zoom.val(Number(this.$zoom.val())+1),this._reloadMap()}}.bind(this);this.$map.on("click",t),this.$editor.is(":visible")&&(this.$map.on("wheel mousewheel",e),this.$editor.on("keyup change",this._reloadMap.bind(this)))},loadData:function(t){Object.keys(t).forEach(function(e){this.$el.find('[name="'+e+'"]').val(t[e])}.bind(this)),this.$editor.hide(),this._reloadMap()},_safeData:function(t){var e={};return Object.keys(t).forEach(function(i){e[i]=encodeURIComponent(t[i])}),e},_reloadMap:function(){var t=this.$map||this.$el.find(".map");this.$el.hasClass("st--is-loading")||(this.loading(),t.css("opacity","0.7")),clearTimeout(this.inputTimeoutId),this.inputTimeoutId=setTimeout(function(){this.ready(),t.css("opacity","1"),t.css("background-image","url("+this._getGmapsStaticImage()+")")}.bind(this),this.inputTimeoutAmount)},_getGmapsLink:function(){return _.template(this.map_link,this._safeData(this.getData().data))},_getGmapsStaticImage:function(){return _.template(this.map_static_img,this._safeData(this.getData().data))}})):console.error("SirTrevor.Blocks.Map could not load because SirTrevor wasn't found")}(),function(){"use strict";return SirTrevor?void(SirTrevor.Blocks.Widget=SirTrevor.Block.extend({type:"widget",title:"Widget",icon_name:"code",pastable:!0,paste_options:{html:['<div style="text-align: center;  padding:20px;">',"  <span>Paste your external widget html here</span>",'  <textarea class="st-paste-block" style="width: 100%; padding: 0.6em; border: 1px solid #D4D4D4;"  placeholder="Paste your code here"></textarea>',"</div>"].join("\n")},_serializeData:function(){return{format:"html",text:this.$el.find("textarea").val()}},loadData:function(t){this.loadPastedContent(t.text)},onContentPasted:function(t){this.loadPastedContent($(t.target).val())},loadPastedContent:function(t){this.$el.find("textarea").val(t),t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;");var e=$("<pre>"),i=$("<code>",{"class":"lang-html"});i.html(t),hljs.highlightBlock(i.get()[0]),e.append(i),this.$editor.html(e),this.$inputs.hide()}})):console.error("SirTrevor.Blocks.Widget could not load because SirTrevor wasn't found")}();